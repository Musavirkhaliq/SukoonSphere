import{u as P,r as o,a as F,b as S,j as e,P as k,F as C,I as A,c as N,L as U,d as E,e as I,f as L,g as O,h as R,i as T,M,k as $}from"./index-CX54NAfH.js";import{B}from"./index-CwYqYvcV.js";const Q=()=>{const[u,n]=P(),c=u.get("filter")||"newest",r=u.get("search")||"",[l,g]=o.useState(r),{ref:b,inView:f}=F(),w=[{value:"newest",label:"Newest",icon:e.jsx(R,{className:"w-4 h-4"})},{value:"oldest",label:"Oldest",icon:e.jsx(T,{className:"w-4 h-4"})},{value:"title",label:"A-Z",icon:e.jsx(M,{className:"w-4 h-4"})}];o.useEffect(()=>{const s=setTimeout(()=>{l!==r&&n(a=>{const t=new URLSearchParams(a);return l?t.set("search",l):t.delete("search"),t})},500);return()=>clearTimeout(s)},[l,r,n]);const y=s=>{n(a=>{const t=new URLSearchParams(a);return t.set("filter",s),t}),window.scrollTo({top:0,behavior:"smooth"})},{data:d,fetchNextPage:p,hasNextPage:m,isFetchingNextPage:x,status:j,refetch:h}=S({queryKey:["articles",c,r],queryFn:async({pageParam:s=1})=>{const a=new URLSearchParams({page:s,limit:9,sortBy:c,...r&&{search:r}});return(await $.get(`articles?${a}`)).data},getNextPageParam:s=>s.pagination.hasNextPage?s.pagination.currentPage+1:void 0,refetchOnWindowFocus:!1,refetchOnMount:!1,cacheTime:5*60*1e3});if(o.useEffect(()=>{h()},[c,h]),o.useEffect(()=>{f&&m&&!x&&p()},[f,p,m,x]),j==="error")return e.jsx("div",{className:"min-h-[60vh] flex flex-col items-center justify-center",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-6 py-4 rounded-lg max-w-md text-center",children:[e.jsx("p",{className:"text-lg font-medium mb-2",children:"Error"}),e.jsx("p",{children:"Failed to load articles. Please try again later."}),e.jsx("button",{onClick:()=>h(),className:"mt-4 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Try Again"})]})});const i=(d==null?void 0:d.pages.flatMap(s=>s.articles))||[];return e.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8 py-4",children:[e.jsx(k,{title:"Articles",description:"Explore our collection of articles written by mental health professionals and experts. Find valuable insights, tips, and information about mental health and well-being."}),e.jsxs("div",{className:"flex flex-col gap-4 mb-6 bg-white rounded-lg shadow-md p-4 md:p-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:l,onChange:s=>g(s.target.value),placeholder:"Search articles...",className:"w-full md:w-1/3 lg:w-1/4 bg-[var(--white-color)] py-2 px-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent"}),e.jsx(C,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),l&&e.jsx("button",{onClick:()=>{g(""),n(s=>{const a=new URLSearchParams(s);return a.delete("search"),a})},className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx(A,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mt-2 md:mt-0",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:w.map(s=>e.jsxs("button",{onClick:()=>y(s.value),className:`px-3 py-1.5 text-sm rounded-full transition-colors flex items-center gap-2 ${c===s.value?"bg-[var(--primary)] text-white":" text-gray-700 hover:bg-gray-200"}`,children:[s.icon,e.jsx("span",{children:s.label})]},s.value))})})]}),j==="loading"?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--primary)]"})}):(i==null?void 0:i.length)===0?e.jsx("div",{className:"text-center p-4 md:p-8 rounded-lg ",children:e.jsxs("div",{className:"flex flex-col items-center justify-center  rounded-xl p-8 space-y-4 text-center",children:[e.jsx("div",{className:"bg-blue-100 p-6 rounded-full",children:e.jsx(N,{className:"w-16 h-16 text-var(--primary) animate-pulse"})}),e.jsxs("div",{className:"max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-[var(--grey--900)] mb-3",children:"No articles found"}),e.jsx("p",{className:"text-[var(--grey--800)] mb-6",children:"Try adjusting your search and filters or check back later for updated articles."})]})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:i.map((s,a)=>{var t,v;return e.jsxs(U,{to:`/articles/article/${s._id}`,className:"group bg-white rounded-xl shadow-sm overflow-hidden border border-gray-100 hover:shadow-md transition-all duration-200 flex flex-col",children:[e.jsx("div",{className:"relative h-48 bg-gradient-to-r from-blue-50 to-indigo-50 overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:s.imageUrl?e.jsx("img",{src:s.imageUrl,alt:s.title,className:"w-full h-full object-cover"}):e.jsx(N,{className:"w-12 h-12 text-blue-200 group-hover:scale-110 transition-transform duration-200"})})}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col",children:[e.jsx("h2",{className:"text-xl font-semibold text-[var(--grey--900)] group-hover:text-blue-600 transition-colors duration-200 mb-3 line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex flex-col gap-3 mt-auto",children:[e.jsxs("div",{className:"flex items-center justify-end gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-[var(--grey--900)]"}),e.jsx("span",{className:"text-[var(--grey--600)]",children:((t=s.likes)==null?void 0:t.length)||0})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-[var(--grey--900)]"}),e.jsx("span",{className:"text-[var(--grey--600)]",children:((v=s.comments)==null?void 0:v.length)||0})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-[var(--grey--600)] pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[s.authorAvatar?e.jsx("img",{src:s.authorAvatar,alt:s.authorName,className:"w-6 h-6 mr-2 object-cover rounded-full"}):e.jsx(I,{className:"w-4 h-4 mr-2"}),e.jsx("span",{children:s.authorName||"Anonymous"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(L,{className:"w-4 h-4 mr-2 text-[var(--grey--900)]"}),e.jsx("span",{children:new Date(s.createdAt).toLocaleDateString()})]})]})]})]})]},`${s._id}-${a}`)})}),m&&e.jsx("div",{ref:b,className:"flex justify-center py-4",children:x?e.jsx(O,{className:"w-6 h-6 text-blue-500 animate-spin"}):e.jsx("div",{className:"h-8"})})]})]})};export{Q as default};
