import{J as C,z as D,R as r,a as S,b as A,k as N,j as e,U as _,L as B,D as T}from"./index-BG9rIXzN.js";import{B as q}from"./index-Bsu3-u_E.js";const $=()=>{const t=C(),{user:c}=D(),[n,I]=r.useState(""),[w,d]=r.useState(!1),[u,b]=r.useState(!1),[z,m]=r.useState(!1),[g,v]=r.useState(null),{ref:k,inView:f}=S(),{data:x,fetchNextPage:j,hasNextPage:l,isFetchingNextPage:o,status:p,refetch:M}=A({queryKey:["userQuestions",t==null?void 0:t._id],queryFn:async({pageParam:s=1})=>(await N.get(`/qa-section/user-questions/${t==null?void 0:t._id}?page=${s}&limit=4`)).data,getNextPageParam:s=>{if(s!=null&&s.pagination)return s.pagination.hasNextPage?s.pagination.currentPage+1:void 0},enabled:!!(t!=null&&t._id),refetchOnWindowFocus:!1,refetchOnMount:!1,cacheTime:5*60*1e3});r.useEffect(()=>{f&&l&&!o&&j()},[f,j,l,o]);const Q=async()=>{m(!0);try{await N.delete(`/qa-section/question/${g}`),M(),d(!1)}catch(s){console.log(s)}m(!1)},y=(x==null?void 0:x.pages.flatMap(s=>s.questions))||[],h=y.filter(s=>{var a,i;return(((a=s.questionText)==null?void 0:a.toLowerCase())||"").includes(n.toLowerCase())||(((i=s.context)==null?void 0:i.toLowerCase())||"").includes(n.toLowerCase())});return e.jsxs("div",{className:"lg:p-6 bg-white rounded-xl shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-4 lg:mb-8",children:e.jsxs("h2",{className:"text-2xl font-bold text-gray-800",children:["Questions"," ",e.jsx("span",{className:"text-blue-500 ml-2",children:h.length})]})}),p==="loading"?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--primary)]"})}):p==="error"?e.jsx("div",{className:"text-center text-red-500 py-4",children:"Error loading questions"}):h.length===0?e.jsxs("div",{className:"text-center py-12 px-4",children:[e.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-700 mb-2",children:n?"No matching questions found":"No questions asked yet"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:n?"Try searching with different keywords":"Start asking questions to get help from the community!"})]}):e.jsxs("div",{className:"space-y-6",children:[h.map(s=>{var a;return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-6 hover:shadow-lg transition-all duration-300",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(_,{createdBy:s.createdBy,username:s.username,userAvatar:s.userAvatar,createdAt:s.createdAt}),(c==null?void 0:c._id)===s.createdBy&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>{v(s._id),b(!u)},className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(q,{className:"text-gray-500"})}),u&&g===s._id&&e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-100 z-10",children:e.jsx("button",{onClick:()=>d(!0),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:"Delete Question"})})]})]}),e.jsx("div",{children:e.jsxs(B,{to:`/QA-section/question/${s._id}`,className:"block",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 hover:text-blue-600 transition-colors mb-2",children:s.questionText}),e.jsx("p",{className:"text-gray-600",children:s.context})]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(a=s.tags)==null?void 0:a.map((i,L)=>e.jsxs("span",{className:"px-3 py-1 bg-blue-50 text-blue-600 rounded-full text-sm",children:["#",i]},L))}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"})}),e.jsxs("span",{children:[s.totalAnswers||0," answers"]})]})})]})},s._id)}),e.jsxs("div",{ref:k,className:"py-4 text-center",children:[o&&e.jsx("div",{className:"text-gray-500",children:"Loading more questions..."}),!o&&l&&e.jsx("div",{className:"text-gray-400",children:"Scroll for more questions"}),!l&&y.length>0&&e.jsx("div",{className:"text-gray-400",children:"No more questions to load"})]})]}),e.jsx(T,{isOpen:w,onClose:()=>d(!1),onDelete:Q,title:"Delete Question",message:"Are you sure you want to delete this question? This action cannot be undone.",itemType:"question"})]})};export{$ as default};
