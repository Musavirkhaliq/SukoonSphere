import{u as v,r as o,a as y,b as P,j as e,P as F,S,F as E,A,c as T,d as k,e as C,M as I,f as M}from"./index-BlL4GbOm.js";const R=()=>{const[u,n]=v(),c=u.get("filter")||"newest",r=u.get("search")||"",[l,j]=o.useState(r),{ref:b,inView:p}=y(),N=[{value:"newest",label:"Newest",icon:e.jsx(k,{className:"w-4 h-4"})},{value:"oldest",label:"Oldest",icon:e.jsx(C,{className:"w-4 h-4"})},{value:"title",label:"A-Z",icon:e.jsx(I,{className:"w-4 h-4"})}];o.useEffect(()=>{const s=setTimeout(()=>{l!==r&&n(a=>{const t=new URLSearchParams(a);return l?t.set("search",l):t.delete("search"),t})},500);return()=>clearTimeout(s)},[l,r,n]);const w=s=>{n(a=>{const t=new URLSearchParams(a);return t.set("filter",s),t}),window.scrollTo({top:0,behavior:"smooth"})},{data:d,fetchNextPage:f,hasNextPage:m,isFetchingNextPage:x,status:g,refetch:h}=P({queryKey:["articles",c,r],queryFn:async({pageParam:s=1})=>{const a=new URLSearchParams({page:s,limit:9,sortBy:c,...r&&{search:r}});return(await M.get(`articles?${a}`)).data},getNextPageParam:s=>s.pagination.hasNextPage?s.pagination.currentPage+1:void 0,refetchOnWindowFocus:!1,refetchOnMount:!1,cacheTime:5*60*1e3});if(o.useEffect(()=>{h()},[c,h]),o.useEffect(()=>{p&&m&&!x&&f()},[p,f,m,x]),g==="error")return e.jsx("div",{className:"min-h-[60vh] flex flex-col items-center justify-center",children:e.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-6 py-4 rounded-lg max-w-md text-center",children:[e.jsx("p",{className:"text-lg font-medium mb-2",children:"Error"}),e.jsx("p",{children:"Failed to load articles. Please try again later."}),e.jsx("button",{onClick:()=>h(),className:"mt-4 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700",children:"Try Again"})]})});const i=(d==null?void 0:d.pages.flatMap(s=>s.articles))||[];return e.jsxs("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8 py-4",children:[e.jsx(F,{title:"Articles",description:"Explore our collection of articles written by mental health professionals and experts. Find valuable insights, tips, and information about mental health and well-being."}),e.jsx("div",{className:"flex flex-col gap-4 mb-6 bg-white rounded-lg shadow-md p-4 md:p-6",children:e.jsx(S,{searchInput:l,setSearchInput:j,setSearchParams:n,filterOptions:N,currentFilter:c,handleFilterChange:w})}),g==="loading"?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[var(--primary)]"})}):(i==null?void 0:i.length)===0?e.jsx("div",{className:"text-center p-4 md:p-8 rounded-lg ",children:e.jsxs("div",{className:"flex flex-col items-center justify-center  rounded-xl p-8 space-y-4 text-center",children:[e.jsx("div",{className:"bg-blue-100 p-6 rounded-full",children:e.jsx(E,{className:"w-16 h-16 text-var(--primary) animate-pulse"})}),e.jsxs("div",{className:"max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-[var(--grey--900)] mb-3",children:"No articles found"}),e.jsx("p",{className:"text-[var(--grey--800)] mb-6",children:"Try adjusting your search and filters or check back later for updated articles."})]})]})}):e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:i.map((s,a)=>e.jsx(A,{article:s,index:a}))}),m&&e.jsx("div",{ref:b,className:"flex justify-center py-4",children:x?e.jsx(T,{className:"w-6 h-6 text-blue-500 animate-spin"}):e.jsx("div",{className:"h-8"})})]})]})};export{R as default};
