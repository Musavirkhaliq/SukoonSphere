import{r as o,w as N,f as p,t,j as e,aC as O,aD as I,aE as k,D as P}from"./index-D4VtgvRl.js";const B=({onImageUrlCopy:D})=>{const[l,i]=o.useState([]),[c,d]=o.useState(null),[y,g]=o.useState(!1),[h,m]=o.useState(!0),[u,f]=o.useState(1),[b,v]=o.useState(!0),{user:a}=N();o.useEffect(()=>{a!=null&&a._id&&x()},[u,a==null?void 0:a._id]),console.log(l);const x=async()=>{try{const s=await p.get(`/gallery/user/${a._id}?page=${u}`),r=s.data.images;i(u===1?r||[]:n=>[...n,...r||[]]),v(s.data.pagination.hasNextPage),m(!1)}catch(s){console.error("Error fetching images:",s),t.error("Failed to load images",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),m(!1),i([])}},j=async s=>{const r=s.target.files[0];if(!r)return;if(!r.type.startsWith("image/")){t.error("Please upload an image file",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0});return}const n=new FormData;n.append("image",r);try{await p.post("/gallery",n,{headers:{"Content-Type":"multipart/form-data"}}),t.success("Image uploaded successfully",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),f(1),x()}catch(w){console.error("Error uploading image:",w),t.error("Failed to upload image",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},C=async()=>{if(c)try{await p.delete(`/gallery/${c._id}`),t.success("Image deleted successfully",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0}),i(l.filter(s=>s._id!==c._id)),g(!1),d(null)}catch(s){console.error("Error deleting image:",s),t.error("Failed to delete image",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Gallery"}),e.jsxs("div",{class:"flex",children:[e.jsx("div",{class:" text-center",children:e.jsx("div",{class:"tooltip tooltip-bottom","data-tip":"Once the image is uploaded, hover on the image to copy the URL. Please delete the image if you no longer need it.",children:e.jsx("button",{class:"size-10 inline-flex justify-center items-center gap-2 rounded-full ",children:e.jsx(O,{className:"w-5 h-5 mr-2 text-[var(--ternery)]"})})})}),e.jsxs("label",{className:"btn-2 cursor-pointer",children:["Upload",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:j})]})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[h?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):l.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[e.jsx("p",{className:"text-center mb-2",children:"No images yet"}),e.jsx("p",{className:"text-sm text-center",children:"Upload images to see them here"})]}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:l.map(s=>e.jsxs("div",{className:"relative group w-[140px] h-[140px]",children:[e.jsx("img",{src:s.imageUrl,alt:"",className:"w-full h-full object-cover rounded-lg"}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 rounded-lg",children:e.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(s.imageUrl),t.success("URL copied to clipboard!",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}catch{t.error("Failed to copy URL",{position:"top-right",autoClose:2e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0})}},className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",title:"Copy image URL",children:e.jsx(I,{className:"w-4 h-4 text-gray-600"})}),e.jsx("button",{onClick:()=>{d(s),g(!0)},className:"p-2 bg-white rounded-full shadow-md hover:bg-gray-100 transition-colors",title:"Delete image",children:e.jsx(k,{className:"w-4 h-4 text-red-500"})})]})})]},s._id))}),b&&!h&&e.jsx("button",{onClick:()=>f(s=>s+1),className:"w-full mt-4 py-2 text-blue-500 hover:text-blue-600 transition-colors",children:"Load more"})]}),e.jsx(P,{isOpen:y,onClose:()=>{g(!1),d(null)},onDelete:C,title:"Delete Image",message:"Are you sure you want to delete this image? This action cannot be undone."})]})};export{B as default};
