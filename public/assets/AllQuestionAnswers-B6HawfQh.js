import{j as e,d as k,e as E,v as I,w as L,h as O,r as u,g as S,a as T,b as B,U,x as H,y as V,D as _,f as D,t as P}from"./index-Dm51yKQ2.js";const K=({activeFilter:l,onFilterChange:c})=>{const d=[{id:"newest",label:"Newest",icon:e.jsx(k,{className:"w-4 h-4"})},{id:"oldest",label:"Oldest",icon:e.jsx(E,{className:"w-4 h-4"})},{id:"mostLiked",label:"Most Liked",icon:e.jsx(I,{className:"w-4 h-4"})}];return e.jsx("div",{className:"bg-slate-50 rounded-lg shadow-sm p-4 py-2 mb-4",children:e.jsx("div",{children:e.jsx("div",{className:"flex gap-2 min-w-max",children:d.map(r=>e.jsxs("button",{onClick:()=>c(r.id),className:`
                                flex items-center  gap-2 px-3 py-2 rounded-full transition-all duration-200 ease-in-out whitespace-nowrap
                                ${l===r.id?"bg-[var(--primary)] text-white shadow-md":"text-[var(--grey--800)] hover:bg-gray-100 hover:shadow-sm"}
                            `,children:[r.icon,e.jsx("span",{className:"text-xs md:text-sm font-medium",children:r.label})]},r.id))})})})},z=()=>{var y,v,f,N,j,b,A;const{user:l}=L(),c=O(),[d,r]=u.useState(!1),[x,C]=u.useState("newest"),{id:m}=S(),{ref:M,inView:g}=T(),{data:t,fetchNextPage:w,hasNextPage:o,isFetchingNextPage:i,status:p,refetch:R}=B({queryKey:["answers",m,x],queryFn:async({pageParam:a=1})=>(await D.get(`/qa-section/question/${m}/answers?page=${a}&limit=10&sortBy=${x}`)).data,getNextPageParam:a=>{if(a.pagination)return a.pagination.hasNextPage?a.pagination.currentPage+1:void 0},refetchOnWindowFocus:!1,refetchOnMount:!1,cacheTime:5*60*1e3});u.useEffect(()=>{g&&o&&!i&&w()},[g,w,o,i]);const Q=a=>{C(a),window.scrollTo({top:0,behavior:"smooth"})},$=async()=>{try{await D.delete(`/qa-section/question/${m}`),P.success("Question deleted successfully"),r(!1),c("/qa-section")}catch(a){console.log(a),P.error("Failed to delete question")}};if(p==="loading")return e.jsx("div",{className:"text-center py-4",children:"Loading answers..."});if(p==="error")return e.jsx("div",{className:"text-center text-red-500 py-4",children:"Error loading answers"});const s=((y=t==null?void 0:t.pages[0])==null?void 0:y.question)||{},h=(t==null?void 0:t.pages.flatMap(a=>a.answers))||[],n=(v=t==null?void 0:t.pages[t.pages.length-1])==null?void 0:v.pagination;return e.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 mb-3 border border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx(U,{createdBy:(f=s==null?void 0:s.author)==null?void 0:f.userId,username:(N=s==null?void 0:s.author)==null?void 0:N.username,userAvatar:(j=s==null?void 0:s.author)==null?void 0:j.userAvatar,createdAt:s==null?void 0:s.createdAt}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"bg-gray-100 text-gray-700 px-4 py-2 rounded-full text-sm font-medium",children:[(n==null?void 0:n.totalAnswers)||0," ",(n==null?void 0:n.totalAnswers)===1?"Answer":"Answers"]}),l&&((b=s==null?void 0:s.author)==null?void 0:b.userId)===(l==null?void 0:l._id)&&e.jsx(H,{handleDelete:()=>r(!0)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg md:text-2xl mb-2 font-bold text-[var(--grey--900)] hover:text-[var(--ternery)] transition-colors duration-200",children:s==null?void 0:s.questionText}),e.jsx("p",{className:"text-base mb-2 leading-relaxed text-[var(--grey--800)]",children:s==null?void 0:s.context}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(A=s==null?void 0:s.tags)==null?void 0:A.map((a,F)=>e.jsxs("span",{className:"bg-blue-50 text-blue-600 px-3 py-1 rounded-full text-sm font-medium hover:bg-blue-100 transition-colors duration-200",children:["#",a]},F))})]}),e.jsx(K,{activeFilter:x,onFilterChange:Q}),e.jsxs("div",{className:"space-y-4",children:[h.map(a=>e.jsx(V,{answer:a,user:l,answerCount:(n==null?void 0:n.totalAnswers)||0},a._id)),e.jsxs("div",{ref:M,className:"py-4 text-center",children:[i&&e.jsx("div",{className:"text-gray-500",children:"Loading more answers..."}),!i&&o&&e.jsx("div",{className:"text-gray-400",children:"Scroll for more answers"}),!o&&h.length>0&&e.jsx("div",{className:"text-gray-400",children:"No more answers to load"}),!o&&h.length===0&&e.jsx("div",{className:"text-gray-400",children:"No answers yet"})]})]}),e.jsx(_,{isOpen:d,onClose:()=>r(!1),onDelete:$,title:"Delete Question",message:"Are you sure you want to delete this question?",itemType:"question"})]})};export{z as default};
