import{z as b,r as n,j as t,U as N,A as k,L as w,a9 as D,D as _,B as s,k as d}from"./index-BG9rIXzN.js";const S=({reply:e,commentId:C,onReplyUpdate:i})=>{const{user:a}=b(),[x,l]=n.useState(!1),[c,u]=n.useState(e.content),[h,o]=n.useState(!1),[f,m]=n.useState(!1),y=async()=>{if(!a){s.error("Please login to like replies!");return}try{await d.patch(`/articles/replies/${e._id}/like`),i()}catch{s.error("Failed to like reply")}},g=()=>{if(!a||a._id!==e.createdBy._id){s.error("You can only edit your own replies!");return}l(!0)},p=async()=>{if(!c.trim()){s.error("Reply cannot be empty!");return}try{await d.patch(`/articles/replies/${e._id}`,{content:c}),l(!1),i(),s.success("Reply updated successfully")}catch{s.error("Failed to update reply")}},j=()=>{o(!0)},v=async()=>{m(!0);try{await d.delete(`/articles/replies/${e._id}`),i(),s.success("Reply deleted successfully"),o(!1)}catch{s.error("Failed to delete reply")}finally{m(!1)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("div",{className:"flex items-center gap-2",children:t.jsx(N,{createdBy:e.createdBy.name,username:e.createdBy.name,userAvatar:e.createdBy.avatar,createdAt:e.createdAt,size:"verySmall"})}),a&&a._id===e.createdBy._id&&t.jsx(k,{handleEdit:g,handleDelete:j})]}),x?t.jsxs("div",{className:"mt-2",children:[t.jsx("textarea",{value:c,onChange:r=>u(r.target.value),className:"w-full p-3 pr-14 border border-gray-100 rounded-xl bg-gray-50 focus:outline-none focus:ring-2 focus:ring-[var(--primary)] focus:border-transparent resize-none text-gray-700",rows:"2"}),t.jsxs("div",{className:"flex gap-2 mt-2",children:[t.jsx("button",{onClick:()=>{l(!1),u(e.content)},className:"btn-red !py-1 text-sm",children:"Cancel"}),t.jsx("button",{onClick:p,className:"btn-2 !py-1 text-sm",children:"Save"})]})]}):t.jsxs("p",{className:"text-sm mt-1",children:[e.replyTo&&e.replyTo._id!==e.commentId&&t.jsxs(w,{to:`/about/user/${e.replyTo._id}`,className:"font-medium text-[var(--ternery)] hover:underline",children:["@",e.replyTo.name," "]}),e.content]}),t.jsx("div",{className:"flex items-center gap-4 mt-2 text-xs",children:t.jsxs("button",{onClick:y,className:`flex items-center gap-1 ${a&&e.likes.includes(a._id)?"text-primary":"text-gray-500"}`,children:[t.jsx(D,{}),t.jsx("span",{children:e.likes.length})]})})]}),t.jsx(_,{isOpen:h,onClose:()=>o(!1),onDelete:v,title:"Delete Reply",message:"Are you sure you want to delete this reply?",itemType:"reply",isLoading:f})]})};export{S as default};
